<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>360 Organic Foodie - Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="style.css">

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    
  </style>
</head>
<body>
     <!-- Desktop Navbar (visible on md and up) -->
      <nav class="navbar navbar-expand-lg bg-white d-none d-md-flex fixed-top">
        <div class="container-fluid">
          <img src="./images/Foodies logo without Banner 1.png" style="width: 50px; height: 50px" alt="">
          <span class="Navlogo1">360 Organic Foodie</span>

          <div class="collapse navbar-collapse">
            <ul class="navbar-nav me-auto">
              <li class="nav-item">
                <div class="input-group Navborder">
                  <button class="btn btn-outline-secondary border-0" type="button">
                    <i class="fas fa-search"></i>
                  </button>
                  <input type="text" class="form-control border-0" placeholder="Search here...">
                </div>
              </li>
            </ul>

            <form class="d-flex">
              <div class="d-flex align-items-center">
                <button class="text-reset me-3 btnSharp"><i class="fa-solid fa-cart-shopping"></i></button>
                <button class="text-reset me-4 btnSharp" onclick="toggleNotification(event)">
                  <i class="fas fa-bell"></i>
                </button>
                <img class="me-3 rounded-circle" src="./images/cheerful-curly-man-with-bristle-points-left-wears-casual-clothes-spectacles 1.png" alt="" width="40" height="40">
                <span class="CustomP-14-400 me-3 text-dark fw-semibold">Michael Owen</span>
              </div>
            </form>
            <!-- notification pop-up  -->
                  <div class="col-md-4" id="notificationPopUp">
                      <div class="card p-3">
                        <div class="d-flex align-items-center justify-content-between mb-2 ">
                            <h6>New Customers</h6>
                            <i class="fa-solid fa-ellipsis" style="color: #cbd3e1;"></i>
                        </div>
                        <hr>
                        <!-- first customer -->
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center">
                                <img src="./images/New Customers List.png" alt="">
                                <div class="ms-3">
                                    <small>Domenica @domenica</small><br>
                                    <small>Comment on Smiles Product</small>
                                </div>
                                
                            </div>
                            <small>1h</small>
                        </div>
                        <!-- second customer -->
                        <div class="d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <img src="./images/New Customers List (1).png" alt="">
                                <div class="ms-3">
                                    <small>Mahfuzul @mahfuzul</small><br>
                                    Repled to your comment on reforest..</small>
                                </div>
                                
                            </div>
                            <small>1d</small>
                            <!-- <i class="fa-solid fa-ellipsis" style="color: #cbd3e1;"></i> -->
                        </div>

                        <!-- third customer  -->
                        <div class="d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <img src="./images/New Customers List (2).png" alt="">
                                <div class="ms-3">
                                    <small>Laurel @laurel</small><br>
                                    <small>Purchased a Smiles Product</small>
                                </div>
                                
                            </div>
                            <small>2d</small>
                        </div>
                        <!-- fourth customer -->
                        <div class="d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <img src="./images/happy-smiling-handsome-man-against-blue-background.png" alt="">
                                <div class="ms-3">
                                    <small>Rosina @rosina</small><br>
                                    <small>Just made a purchase of 5 Coconut<br> Crunches Bites.</small>
                                </div>
                            </div>
                            <small>4h</small>
                        </div>
                        <!-- fifth customer -->
                        <div class="d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <img src="./images/New Customers List.png" alt="">
                                <div class="ms-3">
                                    <small>Domenica @domenica</small><br>
                                    <small>Comment on Smiles Product</small>
                                </div>
                                
                            </div>
                            <small>1h</small>
                        </div>
                        <div class="d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <img src="./images/New Customers List.png" alt="">
                                <div class="ms-3">
                                    <small>Domenica @domenica</small><br>
                                    <small>Comment on Smiles Product</small>
                                </div>
                                
                            </div>
                            <small>1h</small>
                        </div>
                        <div class="d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <img src="./images/New Customers List.png" alt="">
                                <div class="ms-3">
                                    <small>Domenica @domenica</small><br>
                                    <small>Comment on Smiles Product</small>
                                </div>
                                
                            </div>
                            <small>1h</small>
                        </div>
                        <div class="d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <img src="./images/New Customers List.png" alt="">
                                <div class="ms-3">
                                    <small>Domenica @domenica</small><br>
                                    <small>Comment on Smiles Product</small>
                                </div>
                                
                            </div>
                            <small>1h</small>
                        </div>
                      </div>
                    </div>
          </div>
        </div>
      </nav>

      <!-- Mobile Navbar (visible only on sm) -->
      <nav class="navbar bg-white px-3 d-flex justify-content-between align-items-center d-flex d-md-none">
        <!-- Left side -->
        <div class="d-flex align-items-center">
          <!-- Hamburger -->
          <button class="btn p-0 me-3" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu">
            <i class="fa-solid fa-bars fs-4"></i>
          </button>

          <!-- Search -->
          <button class="btn p-0">
            <i class="fa-solid fa-magnifying-glass fs-5 text-muted"></i>
          </button>
        </div>

        <!-- Right side -->
        <div class="d-flex align-items-center">
          <!-- Bell -->
          <button class="btn p-0 me-3 position-relative">
            <i class="fa-regular fa-bell fs-4 text-muted"></i>
            <span class="position-absolute top-0 start-100 translate-middle p-1 bg-success border border-light rounded-circle"></span>
          </button>

          <!-- Profile -->
          <img src="./images/cheerful-curly-man-with-bristle-points-left-wears-casual-clothes-spectacles 1.png"
              class="rounded-circle"
              alt="Profile" width="40" height="40">
        </div>
      </nav>

      <!-- Sidebar (offcanvas for mobile) -->
      <div class="offcanvas offcanvas-start sidebar" tabindex="-1" id="sidebarMenu">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title">Menu</h5>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body p-0">
          <ul class="listItem">
            <li><a href="index.html" class="active" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-house me-3"></i>Dashboard</a></li>
            <li><a href="./orders.html" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-cart-shopping me-3"></i>Orders</a></li>
            <li><a href="./customers.html" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-user me-3"></i>Customers</a></li>
            <li><a href="./inventory.html" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-warehouse me-3"></i>Inventory</a></li>
            <li><a href="./notifications.html" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-bell me-3"></i>Notifications</a></li>
            <hr>
            <li><a href="#" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-message me-3"></i>Reviews</a></li>
            <li><a href="#" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-gear me-3"></i>Settings</a></li>
            <li><a onclick="logOut()" style="cursor:pointer; text-decoration: none; color: #8D98AF"><i class="fa-solid fa-arrow-right-from-bracket me-3"></i>Logout</a></li>
          </ul>
        </div>
      </div>

  <div class="container-fluid ">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-md-2 sidebar d-lg-block d-none">
     <ul class="listItem ">
            <li">
             <a href="index.html" class="active" style="text-decoration: none; color: #8D98AF; "><i class="fa-solid fa-house me-3"></i></span><span>Dashboard</span></a>
            </li>
            
            <li>
               <a href="./orders.html" class="" style="text-decoration: none; color: #8D98AF;"><i class="fa-solid fa-cart-shopping me-3"></i></span><span>Order</span></a>
              </li>
            <li>
             <a href="./customers.html" style="text-decoration: none; color:#8D98AF;"><i class="fa-solid fa-user me-3"></i></span><span>Customers</span></a>
            </li>
            <li>
                <a href="./inventory.html" style="text-decoration: none; color: #8D98AF;"><i class="fa-solid fa-warehouse me-3"></i></span><span>Inventory</span></a>
            </li>
            <li>
                <a href="./notifications.html" style="text-decoration: none; color: #8D98AF;"><i class="fa-solid fa-bell me-3"></i></span><span>Notification</span></a>
            </li>
            <hr>
            <li class="">
                <a href="" style="text-decoration: none; color: #8D98AF;"><i class="fa-solid fa-message me-3"></i></span><span>Reviews</span></a>
            </li>
            <li class="">
                <a href="" style="text-decoration: none; color: #8D98AF;" ><i class="fa-solid fa-gear me-3"></i></span><span>settings</span></a>
            </li>
            

            <button class="Dashbutton mt-5 " style="cursor: pointer;" onclick="logOut()">
             <a  style="text-decoration: none; color:#8D98AF ; "><i class="fa-solid fa-arrow-right-from-bracket me-3"></i></span><span class="logspan">Logout</span></a>
            </li>
       </ul>
    </div>

    <!-- Main Content -->
    <div class="col-md-10 p-4">
      <!-- Top Metrics -->
      <div class="row g-3 mb-4" >
        <div class="col-md-3">
          <div class="metric-card">
            <h5>Total Distribution (Yearly)</h5>
            <h3>$84,573</h3><small class="text-success">+4.2%</small>
            <small class="text-success">+4.2% </small><i class="fa-light fa-arrow-up" style="color: red;"></i>
            <small>Compared to ($3400 last year)</small>
          </div>
        </div>
        <div class="col-md-3">
          <div class="metric-card">
            <h5>Total Distribution (Daily)</h5>
            <h3>$124,055</h3>
            <small class="text-success">+3.2% vs last year</small>
          </div>
        </div>
        <div class="col-md-3">
          <div class="metric-card">
            <h5>Total Distribution (Weekly)</h5>
            <h3>$4,512</h3>
            <small class="text-danger">-2.2% vs last year</small>
          </div>
        </div>
        <div class="col-md-3">
          <div class="metric-card">
            <h5>Total Distribution (Monthly)</h5>
            <h3>$17,856</h3>
            <small class="text-success">+1.8% vs last year</small>
          </div>
        </div>
      </div>

      <!-- Charts -->
      <div class="row g-3 mb-4">
        <div class="col-md-8">
          <div class="card p-3">
            <!-- <img src="./images/Sales statistics.png" alt=""> -->
            <h6>Distribution Trends</h6> 
             <canvas id="trendChart" height="100"></canvas>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card p-3">
            <img src="./images/Daily Visit Insights.png" alt="">
            <!-- <h6>Daily Visit Insights</h6>
            <canvas id="visitChart" height="100"></canvas> -->
          </div>
        </div>
      </div>

      <!-- Best Selling Products + Doughnut -->
     <div class="row g-3 mb-4">
        <div class="col-md-8" >
        <div class="card p-3 " id="TableId">
          <div class="d-flex align-items-center justify-content-between">
          <h6>Avaliable Products</h6>
          </div>
          <div class=" table-responsive" >
          <table class=" table big-table table-borderless" style="height: 400px;">
            <thead class="tablePad">
              <tr class="" style="color: #8D98AF; ">
                <th>Name</th>
                <th>Category</th>
                <th>Stock</th>
                <th>Amount</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
          </div>
          </div>
        </div>

      <!-- Customers & Orders -->
      <div class="row g-3">
       <div class="col-md-4">
          <div class="card p-3">
            <div class="d-flex align-items-center justify-content-between mb-2 ">
                <h6>New Customers</h6>
                <i class="fa-solid fa-ellipsis" style="color: #cbd3e1;"></i>
            </div>
            <hr>
            <!-- first customer -->
            <div class="d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    <img src="./images/New Customers List.png" alt="">
                    <div class="ms-3">
                        <small>Amarise Bilal</small><br>
                        <small>Customer ID#00222</small>
                    </div>
                     
                </div>
                <i class="fa-solid fa-ellipsis" style="color: #cbd3e1;"></i>
            </div>
            <!-- second customer -->
            <div class="d-flex align-items-center justify-content-between mt-3">
                <div class="d-flex align-items-center">
                    <img src="./images/New Customers List.png" alt="">
                    <div class="ms-3">
                        <small>Amarise Bilal</small><br>
                        <small>Customer ID#00222</small>
                    </div>
                     
                </div>
                <i class="fa-solid fa-ellipsis" style="color: #cbd3e1;"></i>
            </div>

            <!-- third customer  -->
            <div class="d-flex align-items-center justify-content-between mt-3">
                <div class="d-flex align-items-center">
                    <img src="./images/New Customers List.png" alt="">
                    <div class="ms-3">
                        <small>Amarise Bilal</small><br>
                        <small>Customer ID#00222</small>
                    </div>
                     
                </div>
                <i class="fa-solid fa-ellipsis" style="color: #cbd3e1;"></i>
            </div>
            <!-- fourth customer -->
            <div class="d-flex align-items-center justify-content-between mt-3">
                <div class="d-flex align-items-center">
                    <img src="./images/New Customers List.png" alt="">
                    <div class="ms-3">
                        <small>Amarise Bilal</small><br>
                        <small>Customer ID#00222</small>
                    </div>
                     
                </div>
                <i class="fa-solid fa-ellipsis" style="color: #cbd3e1;"></i>
            </div>

          </div>
        </div>
        <div class="col-md-8 ">
          <div class="div  ">
          <div class="card p-3 ">
            <h6>Order List</h6>
            <div class="table-responsive">
            <table class="table big-table table-borderless " >
              <thead class="tablePad">
                <tr>
                  <th>Payment Number</th>
                  <th>Date & time</th>
                  <th>Amount</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Payment from #10321</td>
                  <td>Jul 19, 2024, 3:30pm</td>
                  <td>$350.00</td>
                  <td><span class="badge bg-success">Completed</span></td>
                  </tr>
                <tr>
                  <td>Process refund to #00910</td>
                  <td>Jul 01, 2024, 3:30pm</td>
                  <td>$570.00</td>
                  <td><span class="badge bg-danger ">declined</span></td></tr>
                <tr>
                  <td>Process delivery to #44333</td>
                  <td>Jun 21, 2024, 3:30pm</td>
                  <td>$840.00</td>
                  <td><span class="badge bg-success">Completed</span></td>
                </tr>
                <tr>
                  <td>Process refund to #00910</td>
                  <td>May 01, 2024, 3:30pm</td>
                  <td>$570.00</td>
                  <td><span class="badge bg-danger">declined</span></td>
                </tr>
              </tbody>
            </table>
            <div class="text-center">
                <button class="TableBUTon">view All transaction</button>
              </div>
          </div>
          </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>




   <script>
  function escapeHtml(text) {
    const div = document.createElement("div");
    div.innerText = text;
    return div.innerHTML;
  }

  function formatCurrency(amount) {
    return "₦" + Number(amount || 0).toLocaleString("en-NG"); 
  }

  function renderProductsTable(products, containerId = "bestSellingTable") {
    const table = document.getElementById(containerId);
    if (!table) return;

    const tbody = table.querySelector("tbody");
    tbody.innerHTML = "";

    products.forEach(product => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${escapeHtml(product.name)}</td>
        <td>${Number(product.sales || 0).toLocaleString()}</td>
        <td>${Number(product.numberInStock || 0).toLocaleString()}</td>
        <td>${formatCurrency(product.price)}</td>
        <td class="${product.stock > 0 ? "text-success" : "text-danger"}">
          ${product.stock > 0 ? "In Stock" : "Out Of Stock"}
        </td>
      `;
      tbody.appendChild(row);
    });
  }

  async function loadProductsForDashboard() {
    const table = document.getElementById("bestSellingTable");
    if (!table) return;

    try {
      const res = await fetch("http://localhost:3001/amazon/document/api/products");
      if (!res.ok) throw new Error("Failed to fetch products: " + res.status);
      const products = await res.json();

      const list = Array.isArray(products) ? products : (products.data || []);

      // Sort by sales (descending) and pick top 5
      const bestSelling = list
        .sort((a, b) => (b.sales || 0) - (a.sales || 0))
        .slice(0, 5);

      renderProductsTable(bestSelling);
    } catch (err) {
      console.error("Error loading dashboard products:", err);
    }
  }

  document.addEventListener("DOMContentLoaded", loadProductsForDashboard);
</script> 










<!-- <script>
  function renderProductsTable(products, containerId = "bestSellingTable") {
  const table = document.getElementById(containerId);
  if (!table) return;

  const tbody = table.querySelector("tbody");
  tbody.innerHTML = "";

  products.forEach(product => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${escapeHtml(product.name)}</td>
      <td>${Number(product.sales || 0).toLocaleString()}</td>
      <td>${Number(product.stock || 0).toLocaleString()}</td>
      <td>₦${Number(product.price || 0).toLocaleString()}</td>
      <td class="${product.stock > 0 ? "text-success" : "text-danger"}">
        ${product.stock > 0 ? "In Stock" : "Out Of Stock"}
      </td>
    `;
    tbody.appendChild(row);
  });
}

async function loadProductsForDashboard() {
  const table = document.getElementById("bestSellingTable");
  if (!table) return;

  try {
    const res = await fetch("http://localhost:3001/amazon/document/api/products");
    if (!res.ok) throw new Error("Failed to fetch products: " + res.status);
    const products = await res.json();

    const list = Array.isArray(products) ? products : (products.data || []);

    // Sort by sales (descending) and pick top 5
    const bestSelling = list
      .sort((a, b) => (b.sales || 0) - (a.sales || 0))
      .slice(0, 5);

    renderProductsTable(bestSelling);
  } catch (err) {
    console.error("Error loading dashboard products:", err);
  }
}

document.addEventListener("DOMContentLoaded", loadProductsForDashboard);
</script> -->

  

<script>
  // Line Chart
  new Chart(document.getElementById('trendChart'), {
    type: 'line',
    data: {
      labels: ['Jan','Feb','Mar','Apr','May','Jun'],
      datasets: [
        {label:'Orders', data:[200,250,180,300,270,350], borderColor:'#28a745', fill:false},
        {label:'Revenue', data:[300,400,350,500,450,600], borderColor:'#dc3545', fill:false}
      ]
    }
  });

  // Bar Chart
  new Chart(document.getElementById('visitChart'), {
    type: 'bar',
    data: {
      labels: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
      datasets: [{label:'Visits', data:[120,150,180,200,170,140,190], backgroundColor:'#0d6efd'}]
    }
  });

  // Doughnut Chart
  new Chart(document.getElementById('productChart'), {
    type: 'doughnut',
    data: {
      labels: ['Berry Bites','Organic Almond Delight','Coconut Crunch'],
      datasets: [{data:[45,32,23], backgroundColor:['#0d6efd','#20c997','#ffc107']}]
    }
  });

    
</script>



    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.min.js" integrity="sha384-RuyvpeZCxMJCqVUGFI0Do1mQrods/hhxYlcVfGPOfQtPJh0JCw12tUAZ/Mv10S7D" crossorigin="anonymous"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/js/all.min.js" integrity="sha512-b+nQTCdtTBIRIbraqNEwsjB6UvL3UEMkXnhzd8awtCYh0Kcsjl9uEgwVFVbhoj3uu1DO1ZMacNvLoyJJiNfcvg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="index.js"></script>
</body>
</html>
